"use strict";(self.webpackChunkrts_docs=self.webpackChunkrts_docs||[]).push([["3801"],{1616(e,n,s){s.r(n),s.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>o,contentTitle:()=>l,toc:()=>a,assets:()=>c});var r=JSON.parse('{"id":"hpc/storage/sharing_data_on_hpc","title":"Sharing Data on HPC","description":"Introduction","source":"@site/docs/hpc/03_storage/08_sharing_data_on_hpc.mdx","sourceDirName":"hpc/03_storage","slug":"/hpc/storage/sharing_data_on_hpc","permalink":"/docs/hpc/storage/sharing_data_on_hpc","draft":false,"unlisted":false,"editUrl":"https://github.com/NYU-RTS/rts-docs/blob/main/docs/hpc/03_storage/08_sharing_data_on_hpc.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{},"sidebar":"hpcSidebar","previous":{"title":"Transferring Cloud Storage Data with rclone","permalink":"/docs/hpc/storage/transferring_cloud_storage_data_with_rclone"},"next":{"title":"Datasets Available","permalink":"/docs/hpc/datasets/intro"}}'),i=s(62615),t=s(30416);let o={},l="Sharing Data on HPC",c={},a=[{value:"Introduction",id:"introduction",level:2},{value:"Anatomy of an Access Control Entry",id:"anatomy-of-an-access-control-entry",level:3},{value:"Creating and Applying ACLs",id:"creating-and-applying-acls",level:3},{value:"Give someone access to read a particular file",id:"give-someone-access-to-read-a-particular-file",level:4},{value:"Show current access properties",id:"show-current-access-properties",level:4},{value:"Linux Groups for Group Permissions",id:"linux-groups-for-group-permissions",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"sharing-data-on-hpc",children:"Sharing Data on HPC"})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"To share files on the cluster with other users, we recommend using NFSv4 Access Control Lists (ACL) for a user to share access to their data with others. NFSv4 ACL mechanism allows for fine-grained control access to any files by any users or groups of users."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["We discourage users from setting ",(0,i.jsx)(n.code,{children:"777"})," permissions with ",(0,i.jsx)(n.code,{children:"chmod"}),", because this can lead to data loss (by a malicious user or unintentionally, by accident)."]})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Torch supports NFSv4 ACLs rather than the POSIX ACLs supported by Greene! NFSv4 ACLs allow for more fine grained control when compared to POSIX ACLs."})}),"\n",(0,i.jsx)(n.h3,{id:"anatomy-of-an-access-control-entry",children:"Anatomy of an Access Control Entry"}),"\n",(0,i.jsx)(n.p,{children:"An Access Control List is composed of Access Control Entries, each of which has the following structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[type]:[flags]:[principal]:[permissions]\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Property"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"type"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Kind of ACE entry, we recommend only using A (access). Deny type entries make the ACE more complex to reason about when compared to using only access type entries for the same configuration."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"flags"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Inheritance flags which apply to directories and control how ACEs are inherited:",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"f"})}),": files inherit ACEs, but inheritance flags are not set on the files",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"d"})}),": directories inherit both the ACE and the inheritance flags",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"i"})}),": only inherit the inheritance flags, ACEs do not apply to this directory",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"n"})}),": directories only inherit ACEs, not the inheritance flags",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"g"})}),": only used when the principal is a group"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"principal"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["The user (identified by ",(0,i.jsx)(n.code,{children:"NetID"}),") or group to apply the ACE to, with the following special principals:",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"OWNER"})}),(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"GROUP"})}),(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"EVERYONE"})})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"permissions"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["The level of access to grant. Aliases for most common uses include: the full set of permission entry types are listed below for reference, with the most commonly used options being:",(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"R"})}),": Read, alias for ",(0,i.jsx)(n.code,{children:"rntcy"}),(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"W"})}),": Write, alias for ",(0,i.jsx)(n.code,{children:"watTNcCy"}),(0,i.jsx)("br",{}),"- ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"X"})}),": Execute, alias for ",(0,i.jsx)(n.code,{children:"watTNcCy"})," ",(0,i.jsx)("br",{})," The full list of available options can be found ",(0,i.jsx)(n.a,{href:"https://man7.org/linux/man-pages/man5/nfs4_acl.5.html",children:"here"}),"."]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"creating-and-applying-acls",children:"Creating and Applying ACLs"}),"\n",(0,i.jsx)(n.p,{children:"The following commands are available:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nfs4_setfacl"})," to set ACEs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nfs4_editfacl"})," to edit ACEs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nfs4_getfacl"})," to view ACLs\nwith the usage described in the following examples."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"give-someone-access-to-read-a-particular-file",children:"Give someone access to read a particular file"}),"\n",(0,i.jsx)(n.p,{children:"Append the ACL for that file by adding an ACE via"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'nfs4_setfacl -a "A::NetID:R" filename\n'})}),"\n",(0,i.jsxs)(n.p,{children:["where the ",(0,i.jsx)(n.code,{children:"-a"}),' flag signifies "append". Since inheritance flags are only applicable to directories and the principal is not a group, no flags are needed.']}),"\n",(0,i.jsx)(n.h4,{id:"show-current-access-properties",children:"Show current access properties"}),"\n",(0,i.jsx)(n.p,{children:"Create an empty file and view the default ACEs it:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"~> touch temp\n~> nfs4_getfacl temp \n# file: temp\nA::OWNER@:rwatTnNcy\nA:g:GROUP@:rtncy\nA::EVERYONE@:rtncy\n"})}),"\n",(0,i.jsx)(n.p,{children:"View changes after granting a collaborator read permissions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:'~> nfs4_setfacl -a "A::collaborator-netid:R" temp \n~> nfs4_getfacl temp\n# file: temp\nA::collaborator-netid@hpc.nyu.edu:rtncy\nA::OWNER@:rwatTnNcy\nA:g:GROUP@:rtncy\nA::EVERYONE@:rtncy\n'})}),"\n",(0,i.jsxs)(n.p,{children:["where ",(0,i.jsx)(n.code,{children:"collaborator-netid"})," refers to the ",(0,i.jsx)(n.code,{children:"NetID"})," of your collaborator."]}),"\n",(0,i.jsx)(n.h2,{id:"linux-groups-for-group-permissions",children:"Linux Groups for Group Permissions"}),"\n",(0,i.jsx)(n.p,{children:"The HPC team allows teams to manage group membership using a IPA Linux Group. This is a good choice for when all users need the same read/write/execute permissions for a directory and subdirectories."}),"\n",(0,i.jsxs)(n.p,{children:["Please email ",(0,i.jsx)(n.a,{href:"mailto:hpc@nyu.edu",children:"hpc@nyu.edu"})," if your team would like to use a Linux Group. Generally this will follow some kind of naming convention along the lines of:"]}),"\n",(0,i.jsx)(n.p,{children:"g-DEPT-LABNAME"}),"\n",(0,i.jsxs)(n.p,{children:["Once you have a group assigned, managers of the group can use the ",(0,i.jsx)(n.code,{children:"ipa"})," commands to manage members via the login nodes."]}),"\n",(0,i.jsx)(n.p,{children:"Relevant user commands include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-add-member"}),": Add members to a group.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Example:\n",(0,i.jsx)(n.code,{children:"ipa group-add-member GROUP-NAME --users='NETID'"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-add-member-manager"}),": Add users that can manage members of this group.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Example:\n",(0,i.jsx)(n.code,{children:"ipa group-add-member-manager GROUP-NAME --users='NETID'"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-find"}),": Search for groups.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Example:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"ipa group-find test\n----------------\n2 groups matched\n----------------\n  Group name: g-test-2222\n  GID: 891200121\n\n  Group name: g-test-2223\n  Description: g-test-2223\n  GID: 891200122\n----------------------------\nNumber of entries returned 2\n----------------------------\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-remove-member"}),": Remove members from a group.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Example:\n",(0,i.jsx)(n.code,{children:"ipa group-remove-member --users=NETID"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-remove-member-manager"}),": Remove users that can manage members of this group.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Example:\n",(0,i.jsx)(n.code,{children:"ipa group-remove-member-manager --users=NETID"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ipa group-show"}),": Display information about a named group.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Example:\n",(0,i.jsx)(n.code,{children:"ipa group-show GROUP-NAME"})]}),"\n",(0,i.jsx)(n.li,{children:"Example:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[mdw303@torch-login-1 ~]$ ipa group-show g-hpc-mdw303test\n  Group name: g-hpc-mdw303test\n  Description: test RPS group directory\n  GID: 891200193\n  Member users: mdw303, sw77\n  Membership managed by users: mdw303\n"})})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},30416(e,n,s){s.d(n,{R:()=>o,x:()=>l});var r=s(59471);let i={},t=r.createContext(i);function o(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);