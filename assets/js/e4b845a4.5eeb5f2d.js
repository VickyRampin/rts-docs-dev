"use strict";(self.webpackChunkrts_docs=self.webpackChunkrts_docs||[]).push([["781"],{60171(e,n,o){o.r(n),o.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>s,contentTitle:()=>a,toc:()=>c,assets:()=>l});var r=JSON.parse('{"id":"hpc/storage/transferring_cloud_storage_data_with_rclone","title":"Transferring Cloud Storage Data with rclone","description":"Globus is the recommended tool to use for large-volume data transfers due to the efficiency, reliability, security and ease of use. Use other tools only if you really need to. Detailed instructions available at Globus","source":"@site/docs/hpc/03_storage/07_transferring_cloud_storage_data_with_rclone.md","sourceDirName":"hpc/03_storage","slug":"/hpc/storage/transferring_cloud_storage_data_with_rclone","permalink":"/docs/hpc/storage/transferring_cloud_storage_data_with_rclone","draft":false,"unlisted":false,"editUrl":"https://github.com/NYU-RTS/rts-docs/blob/main/docs/hpc/03_storage/07_transferring_cloud_storage_data_with_rclone.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{},"sidebar":"hpcSidebar","previous":{"title":"Large Number of Small Files","permalink":"/docs/hpc/storage/large_number_of_small_files"},"next":{"title":"Sharing Data on HPC","permalink":"/docs/hpc/storage/sharing_data_on_hpc"}}'),t=o(62615),i=o(30416);let s={},a="Transferring Cloud Storage Data with rclone",l={},c=[{value:"Transferring files to and from Google Drive with RCLONE",id:"transferring-files-to-and-from-google-drive-with-rclone",level:2},{value:"rclone Configuration",id:"rclone-configuration",level:2},{value:"Step 1: Login to Torch:",id:"step-1-login-to-torch",level:3},{value:"Step 2: Load the rclone module",id:"step-2-load-the-rclone-module",level:3},{value:"Step 3: Configure rclone",id:"step-3-configure-rclone",level:3},{value:"Step 4: Transfer",id:"step-4-transfer",level:3},{value:"Step 5: Confirmation",id:"step-5-confirmation",level:3}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"transferring-cloud-storage-data-with-rclone",children:"Transferring Cloud Storage Data with rclone"})}),"\n",(0,t.jsx)(n.admonition,{title:"Globus",type:"tip",children:(0,t.jsxs)(n.p,{children:["Globus is the recommended tool to use for large-volume data transfers due to the efficiency, reliability, security and ease of use. Use other tools only if you really need to. Detailed instructions available at ",(0,t.jsx)(n.a,{href:"/docs/hpc/storage/globus",children:"Globus"})]})}),"\n",(0,t.jsx)(n.h2,{id:"transferring-files-to-and-from-google-drive-with-rclone",children:"Transferring files to and from Google Drive with RCLONE"}),"\n",(0,t.jsxs)(n.p,{children:["Having access to Google Drive from the HPC environment provides an option to archive data and even share data with collaborators who have no access to the NYU HPC environment. Other options to archiving data include the HPC Archive file system and using ",(0,t.jsx)(n.a,{href:"/docs/hpc/storage/globus",children:"Globus"})," to share data with collaborators."]}),"\n",(0,t.jsxs)(n.p,{children:["Access to Google Drive is provided by ",(0,t.jsx)(n.a,{href:"https://rclone.org/drive/",children:"rclone"})," - rsync for cloud storage - a command line program to sync files and directories to and from cloud storage systems such as Google Drive, Amazon Drive, S3, B2 etc. ",(0,t.jsx)(n.a,{href:"https://rclone.org/drive/",children:"rclone"})," is available on Torch cluster as a module, the module versions currently available (March 2025) are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"rclone/1.68.2"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"rclone/1.66.0"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"rclone/1.60.1"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For more details on how to use rclone to sync files to Google Drive, please see: ",(0,t.jsx)(n.a,{href:"https://rclone.org/drive/",children:"RClone documentation for Google Drive"})]}),"\n",(0,t.jsx)(n.p,{children:"rclone can be invoked in one of the three modes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://rclone.org/commands/rclone_copy/",children:"Copy"})," mode to just copy new/changed files"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://rclone.org/commands/rclone_sync/",children:"Sync"})," (one way) mode to make a directory identical"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://rclone.org/commands/rclone_check/",children:"Check"})," mode to check for file hash equality"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Please try with these options:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"rclone --transfers=32 --checkers=16 --drive-chunk-size=16384k --drive-upload-cutoff=16384k copy source:sourcepath dest:destpath\n"})}),"\n",(0,t.jsx)(n.p,{children:"This option works great for file sizes 1Gb+ to 250GB. Keep in mind that there is a rate limiting of 2 files/sec for upload into Google Drive.  Small file transfers don\u2019t work that well. If you have many small jobs, please tar the parent directory of such folders and split the tar file into 100GB chunks and then uploads then into Google Drive."}),"\n",(0,t.jsx)(n.h2,{id:"rclone-configuration",children:"rclone Configuration"}),"\n",(0,t.jsx)(n.p,{children:"You need to configure rclone before you will be able to move files between the HPC Environment and Google Drive"}),"\n",(0,t.jsxs)(n.p,{children:["There are specific instruction on the ",(0,t.jsx)(n.a,{href:"https://rclone.org/drive/",children:"rclone web site"})," and here is an example of the process for configuring rclone for use on Torch:"]}),"\n",(0,t.jsx)(n.h3,{id:"step-1-login-to-torch",children:"Step 1: Login to Torch:"}),"\n",(0,t.jsxs)(n.p,{children:["Follow ",(0,t.jsx)(n.a,{href:"/docs/hpc/connecting_to_hpc/connecting_to_hpc",children:"instructions"})," to log into the Torch HPC cluster."]}),"\n",(0,t.jsx)(n.h3,{id:"step-2-load-the-rclone-module",children:"Step 2: Load the rclone module"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ module load rclone/1.68.2\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-3-configure-rclone",children:"Step 3: Configure rclone"}),"\n",(0,t.jsx)(n.p,{children:"Configuring rclone and setting up remote access to your Google Drive, using the command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ rclone config\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will try to open the config files and you will see the below content:"}),"\n",(0,t.jsx)(n.p,{children:"You can select one of the options (here we show how to set up a new remote)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'2025/03/14 16:39:23 NOTICE: Config file "/Users/$USER/.config/rclone/rclone.conf" not found - using defaults\nNo remotes found, make a new one?\nn) New remote\ns) Set configuration password\nq) Quit config\nn/s/q> n\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Please enter ",(0,t.jsx)(n.code,{children:"n"})," to create a new remote"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Enter name for new remote.\nname> nyu_google_drive\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Please enter ",(0,t.jsx)(n.code,{children:"nyu_google_drive"})," or something similar to name the new remote"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Option Storage.\nType of storage to configure.\nChoose a number from below, or type in your own value.\n 1 / 1Fichier\n   \\ (fichier)\n 2 / Akamai NetStorage\n   \\ (netstorage)\n 3 / Alias for an existing remote\n   \\ (alias)\n 4 / Amazon S3 Compliant Storage Providers including AWS, Alibaba, ArvanCloud, Ceph, ChinaMobile, Cloudflare, DigitalOcean, Dreamhost, GCS, HuaweiOBS, IBMCOS, IDrive, IONOS, LyveCloud, Leviia, Liara, Linode, Magalu, Minio, Netease, Petabox, RackCorp, Rclone, Scaleway, SeaweedFS, StackPath, Storj, Synology, TencentCOS, Wasabi, Qiniu and others\n   \\ (s3)\n 5 / Backblaze B2\n   \\ (b2)\n 6 / Better checksums for other remotes\n   \\ (hasher)\n 7 / Box\n   \\ (box)\n 8 / Cache a remote\n   \\ (cache)\n 9 / Citrix Sharefile\n   \\ (sharefile)\n10 / Combine several remotes into one\n   \\ (combine)\n11 / Compress a remote\n   \\ (compress)\n12 / Dropbox\n   \\ (dropbox)\n13 / Encrypt/Decrypt a remote\n   \\ (crypt)\n14 / Enterprise File Fabric\n   \\ (filefabric)\n15 / FTP\n   \\ (ftp)\n16 / Files.com\n   \\ (filescom)\n17 / Gofile\n   \\ (gofile)\n18 / Google Cloud Storage (this is not Google Drive)\n   \\ (google cloud storage)\n19 / Google Drive\n   \\ (drive)\n20 / Google Photos\n   \\ (google photos)\n21 / HTTP\n   \\ (http)\n22 / Hadoop distributed file system\n   \\ (hdfs)\n23 / HiDrive\n   \\ (hidrive)\n24 / ImageKit.io\n   \\ (imagekit)\n25 / In memory object storage system.\n   \\ (memory)\n26 / Internet Archive\n   \\ (internetarchive)\n27 / Jottacloud\n   \\ (jottacloud)\n28 / Koofr, Digi Storage and other Koofr-compatible storage providers\n   \\ (koofr)\n29 / Linkbox\n   \\ (linkbox)\n30 / Local Disk\n   \\ (local)\n31 / Mail.ru Cloud\n   \\ (mailru)\n32 / Mega\n   \\ (mega)\n33 / Microsoft Azure Blob Storage\n   \\ (azureblob)\n34 / Microsoft Azure Files\n   \\ (azurefiles)\n35 / Microsoft OneDrive\n   \\ (onedrive)\n36 / OpenDrive\n   \\ (opendrive)\n37 / OpenStack Swift (Rackspace Cloud Files, Blomp Cloud Storage, Memset Memstore, OVH)\n   \\ (swift)\n38 / Oracle Cloud Infrastructure Object Storage\n   \\ (oracleobjectstorage)\n39 / Pcloud\n   \\ (pcloud)\n40 / PikPak\n   \\ (pikpak)\n41 / Pixeldrain Filesystem\n   \\ (pixeldrain)\n42 / Proton Drive\n   \\ (protondrive)\n43 / Put.io\n   \\ (putio)\n44 / QingCloud Object Storage\n   \\ (qingstor)\n45 / Quatrix by Maytech\n   \\ (quatrix)\n46 / SMB / CIFS\n   \\ (smb)\n47 / SSH/SFTP\n   \\ (sftp)\n48 / Sia Decentralized Cloud\n   \\ (sia)\n49 / Storj Decentralized Cloud Storage\n   \\ (storj)\n50 / Sugarsync\n   \\ (sugarsync)\n51 / Transparently chunk/split large files\n   \\ (chunker)\n52 / Uloz.to\n   \\ (ulozto)\n53 / Union merges the contents of several upstream fs\n   \\ (union)\n54 / Uptobox\n   \\ (uptobox)\n55 / WebDAV\n   \\ (webdav)\n56 / Yandex Disk\n   \\ (yandex)\n57 / Zoho\n   \\ (zoho)\n58 / premiumize.me\n   \\ (premiumizeme)\n59 / seafile\n   \\ (seafile)\nStorage> 19\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Please enter the number that corresponds to ",(0,t.jsx)(n.code,{children:"Google Drive"}),". In the example above it is ",(0,t.jsx)(n.code,{children:"19"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Option client_id.\nGoogle Application Client Id\nSetting your own is recommended.\nSee https://rclone.org/drive/#making-your-own-client-id for how to create your own.\nIf you leave this blank, it will use an internal key which is low performance.\nEnter a value. Press Enter to leave empty.\nclient_id> \n"})}),"\n",(0,t.jsx)(n.p,{children:"Please leave this field blank and hit enter/return."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Option client_secret.\nOAuth Client Secret.\nLeave blank normally.\nEnter a value. Press Enter to leave empty.\nclient_secret> \n"})}),"\n",(0,t.jsx)(n.p,{children:"Please leave this field blank and hit enter/return."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'Scope that rclone should use when requesting access from drive.\nEnter a string value. Press Enter for the default ("").\nChoose a number from below, or type in your own value\n 1 / Full access all files, excluding Application Data Folder.\n   \\ "drive"\n 2 / Read-only access to file metadata and file contents.\n   \\ "drive.readonly"\n   / Access to files created by rclone only.\n 3 | These are visible in the drive website.\n   | File authorization is revoked when the user deauthorizes the app.\n   \\ "drive.file"\n   / Allows read and write access to the Application Data folder.\n 4 | This is not visible in the drive website.\n   \\ "drive.appfolder"\n   / Allows read-only access to file metadata but\n 5 | does not allow any access to read or download file content.\n   \\ "drive.metadata.readonly"\nscope> 1\n'})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 1 or the number corresponding to the option for 'full access' if the options above have changed."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'Service Account Credentials JSON file path\nLeave blank normally.\nNeeded only if you want use SA instead of interactive login.\nLeading `~` will be expanded in the file name as will environment variables such as `${RCLONE_CONFIG_DIR}`.\nEnter a string value. Press Enter for the default ("").\nservice_account_file>\n'})}),"\n",(0,t.jsx)(n.p,{children:"Please leave blank and hit enter/return."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Edit advanced config? (y/n)\ny) Yes\nn) No (default)\ny/n> n\n"})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 'n'."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Use web browser to automatically authenticate rclone with remote?\n * Say Y if the machine running rclone has a web browser you can use\n * Say N if running rclone on a (remote) machine without web browser access\nIf not sure try Y. If Y failed, try N.\n\ny) Yes (default)\nn) No\ny/n> \n"})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 'n'"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'Option config_token.\nFor this to work, you will need rclone available on a machine that has\na web browser available.\nFor more help and alternate methods see: https://rclone.org/remote_setup/\nExecute the following on the machine with the web browser (same rclone\nversion recommended):\n	rclone authorize "drive" "eyJzY29wZSI6ImRyaXZlIn0"\nThen paste the result.\nEnter a value.\nconfig_token> \n'})}),"\n",(0,t.jsxs)(n.p,{children:["As instructed, please copy the line in the output you get that is similar to:\n",(0,t.jsx)(n.code,{children:'rclone authorize "drive" "eyJzY29wZSI6ImRyaXZlIn0"'}),"\nand paste that into a terminal on your local system and press enter/return."]}),"\n",(0,t.jsx)(n.p,{children:"That should open a web browser that will have you select your NYU account and will verify that you would like to give rclone access to your Google Drive.  It will then provide you with a long code:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'user@ITS tmp % rclone authorize "drive" "eysi39xv82pmJzY29XZlIn0"\n2025/03/21 11:12:29 NOTICE: Make sure your Redirect URL is set to "http://127.0.0.1:53682/" in your custom config.\n2025/03/21 11:12:29 NOTICE: If your browser doesn\'t open automatically go to the following link: http://127.0.0.1:53682/auth?state=4c5yNwx6EsFWeise83svie\n2025/03/21 11:12:29 NOTICE: Log in and authorize rclone for access\n2025/03/21 11:12:29 NOTICE: Waiting for code...\n2025/03/21 11:12:39 NOTICE: Got code\nPaste the following into your remote machine ---\x3e\ncode removed\n<---End paste\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Please copy this code and paste it in as a response to the ",(0,t.jsx)(n.code,{children:"config_token>"})," prompt."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Configure this as a team drive?\ny) Yes\nn) No (default)\ny/n> n\n"})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 'n'."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'--------------------\n[remote1]\ntype = drive\nscope = drive\ntoken = {"access_token":", removed "}\n--------------------\ny) Yes this is OK (default)\ne) Edit this remote\nd) Delete this remote\ny/e/d> y\n'})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 'y'."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"Current remotes:\nName                 Type\n====                 ====\nremote1              drive\ne) Edit existing remote\nn) New remote\nd) Delete remote\nr) Rename remote\nc) Copy remote\ns) Set configuration password\nq) Quit config\ne/n/d/r/c/s/q> q\n"})}),"\n",(0,t.jsx)(n.p,{children:"Please enter 'q' and we're done with configuration."}),"\n",(0,t.jsx)(n.h3,{id:"step-4-transfer",children:"Step 4: Transfer"}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Please be sure to perform data transfers on a data transfer node (DTN).  It can degrade performance for other users to perform transfers on other types of nodes.  For more information please see ",(0,t.jsx)(n.a,{href:"/docs/hpc/storage/data_transfers",children:"Data Transfers"})]})}),"\n",(0,t.jsx)(n.p,{children:"Sample commands:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ rclone lsd nyu_google_drive:\n"})}),"\n",(0,t.jsx)(n.p,{children:"Transfer files to Google Drive, using the command below:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ rclone copy <source_folder or file> <remote_name>:<name_of_folder_on_gdrive>\n"})}),"\n",(0,t.jsx)(n.p,{children:"It looks something like below:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ rclone copy /home/user1 nyu_google_drive:backup_home_user1\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-5-confirmation",children:"Step 5: Confirmation"}),"\n",(0,t.jsx)(n.p,{children:"The files are transferred and you can find the files on your Google Drive."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Rclone only copies new files or files different from the already existing files on Google Drive."})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},30416(e,n,o){o.d(n,{R:()=>s,x:()=>a});var r=o(59471);let t={},i=r.createContext(t);function s(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);