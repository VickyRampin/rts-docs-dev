"use strict";(self.webpackChunkrts_docs=self.webpackChunkrts_docs||[]).push([["9101"],{45396(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>a,contentTitle:()=>o,toc:()=>c,assets:()=>l});var r=JSON.parse('{"id":"hpc/tutorial_intro_hpc/transferring_files_remote","title":"Transferring files with remote computers","description":"Questions","source":"@site/docs/hpc/13_tutorial_intro_hpc/07_transferring_files_remote.mdx","sourceDirName":"hpc/13_tutorial_intro_hpc","slug":"/hpc/tutorial_intro_hpc/transferring_files_remote","permalink":"/docs/hpc/tutorial_intro_hpc/transferring_files_remote","draft":false,"unlisted":false,"editUrl":"https://github.com/NYU-RTS/rts-docs/blob/main/docs/hpc/13_tutorial_intro_hpc/07_transferring_files_remote.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{},"sidebar":"hpcSidebar","previous":{"title":"Accessing software via Modules","permalink":"/docs/hpc/tutorial_intro_hpc/modules"},"next":{"title":"Running a parallel job","permalink":"/docs/hpc/tutorial_intro_hpc/running_parallel_job"}}'),i=t(62615),s=t(30416);let a={},o="Transferring files with remote computers",l={},c=[{value:"Archiving Files",id:"archiving-files",level:2},{value:"Transferring Single Files and Folders With <code>scp</code>",id:"transferring-single-files-and-folders-with-scp",level:2},{value:"Transferring a Directory",id:"transferring-a-directory",level:2},{value:"Transferring Files Interactively with FileZilla",id:"transferring-files-interactively-with-filezilla",level:2},{value:"Limiting Factors of Data Transfer Speed",id:"limiting-factors-of-data-transfer-speed",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"transferring-files-with-remote-computers",children:"Transferring files with remote computers"})}),"\n",(0,i.jsxs)(n.admonition,{title:"Overview",type:"info",children:[(0,i.jsx)(n.p,{children:"Questions"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"How do I transfer files to (and from) the cluster?"}),"\n"]}),(0,i.jsx)(n.p,{children:"Objectives"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Transfer files to and from a computing cluster."}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:"Performing work on a remote computer is not very useful if we cannot get files to or from the cluster. There are several options for transferring data between computing resources using CLI and GUI utilities, a few of which we will cover."}),"\n",(0,i.jsx)(n.h1,{id:"download-lesson-files-from-the-internet",children:"Download Lesson Files From the Internet"}),"\n",(0,i.jsxs)(n.p,{children:["One of the most straightforward ways to download files is to use either ",(0,i.jsx)(n.code,{children:"curl"})," or ",(0,i.jsx)(n.code,{children:"wget"}),". One of these is usually installed in most Linux shells, on Mac OS terminal and in GitBash. Any file that can be downloaded in your web browser through a direct link can be downloaded using curl or wget. This is a quick way to download datasets or source code. The syntax for these commands is:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"wget [-O new_name] https://some/link/to/a/file"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"curl [-o new_name] https://some/link/to/a/file"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Try it out by downloading some material we\u2019ll use later on, from a terminal on your local machine, using the URL of the current codebase:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/hpc-carpentry/amdahl/tarball/main",children:"https://github.com/hpc-carpentry/amdahl/tarball/main"})}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsxs)(n.admonition,{title:"Download the \u201CTarball\u201D",type:"info",children:[(0,i.jsxs)(n.p,{children:["The word \u201Ctarball\u201D in the above URL refers to a compressed archive format commonly used on Linux, which is the operating system the majority of HPC cluster machines run. A tarball is a lot like a ",(0,i.jsx)(n.code,{children:".zip"})," file. The actual file extension is ",(0,i.jsx)(n.code,{children:".tar.gz"}),", which reflects the two-stage process used to create the file: the files or folders are merged into a single file using ",(0,i.jsx)(n.code,{children:"tar"}),", which is then compressed using ",(0,i.jsx)(n.code,{children:"gzip"}),", so the file extension is \u201Ctar-dot-g-z.\u201D That\u2019s a mouthful, so people often say \u201Cthe xyz tarball\u201D instead."]}),(0,i.jsxs)(n.p,{children:["You may also see the extension ",(0,i.jsx)(n.code,{children:".tgz"}),", which is just an abbreviation of ",(0,i.jsx)(n.code,{children:".tar.gz"}),"."]}),(0,i.jsxs)(n.p,{children:["By default, ",(0,i.jsx)(n.code,{children:"curl"})," and ",(0,i.jsx)(n.code,{children:"wget"})," download files to the same name as the URL: in this case, ",(0,i.jsx)(n.code,{children:"main"}),". Use one of the above commands to save the tarball as ",(0,i.jsx)(n.code,{children:"amdahl.tar.gz"}),". ",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.strong,{children:"[Click for Solution]"})]})]})}),(0,i.jsxs)(n.admonition,{title:"wget and curl Commands",type:"tip",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ wget -O amdahl.tar.gz https://github.com/hpc-carpentry/amdahl/tarball/main\n# or\n[user@laptop ~]$ curl -o amdahl.tar.gz -L https://github.com/hpc-carpentry/amdahl/tarball/main\n"})}),(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"-L"})," option to ",(0,i.jsx)(n.code,{children:"curl"})," tells it to follow URL redirects (which ",(0,i.jsx)(n.code,{children:"wget"})," does by default)."]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["After downloading the file, use ",(0,i.jsx)(n.code,{children:"ls"})," to see it in your working directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ ls\n"})}),"\n",(0,i.jsx)(n.h2,{id:"archiving-files",children:"Archiving Files"}),"\n",(0,i.jsx)(n.p,{children:"One of the biggest challenges we often face when transferring data between remote HPC systems is that of large numbers of files. There is an overhead to transferring each individual file and when we are transferring large numbers of files these overheads combine to slow down our transfers to a large degree."}),"\n",(0,i.jsxs)(n.p,{children:["The solution to this problem is to ",(0,i.jsx)(n.em,{children:"archive"})," multiple files into smaller numbers of larger files before we transfer the data to improve our transfer efficiency. Sometimes we will combine archiving with ",(0,i.jsx)(n.em,{children:"compression"})," to reduce the amount of data we have to transfer and so speed up the transfer. The most common archiving command you will use on a (Linux) HPC cluster is ",(0,i.jsx)(n.code,{children:"tar"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tar"})," can be used to combine files and folders into a single archive file and, optionally, compress the result. Let\u2019s look at the file we downloaded from the lesson site, ",(0,i.jsx)(n.code,{children:"amdahl.tar.gz"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:".gz"})," part stands for ",(0,i.jsx)(n.code,{children:"gzip"}),", which is a compression library. It\u2019s common (but not necessary!) that this kind of file can be interpreted by reading its name: it appears somebody took files and folders relating to something called \u201Camdahl,\u201D wrapped them all up into a single file with ",(0,i.jsx)(n.code,{children:"tar"}),", then compressed that archive with ",(0,i.jsx)(n.code,{children:"gzip"})," to save space."]}),"\n",(0,i.jsxs)(n.p,{children:["Let\u2019s see if that is the case, ",(0,i.jsx)(n.em,{children:"without"})," unpacking the file. ",(0,i.jsx)(n.code,{children:"tar"})," prints the \u201Ctable of contents\u201D with the ",(0,i.jsx)(n.code,{children:"-t"})," flag, for the file specified with the ",(0,i.jsx)(n.code,{children:"-f"})," flag followed by the filename. Note that you can concatenate the two flags: writing ",(0,i.jsx)(n.code,{children:"-t -f"})," is interchangeable with writing ",(0,i.jsx)(n.code,{children:"-tf"})," together. However, the argument following ",(0,i.jsx)(n.code,{children:"-f"})," must be a filename, so writing ",(0,i.jsx)(n.code,{children:"-ft"})," will ",(0,i.jsx)(n.em,{children:"not"})," work."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ tar -tf amdahl.tar.gz\nhpc-carpentry-amdahl-46c9b4b/\nhpc-carpentry-amdahl-46c9b4b/.github/\nhpc-carpentry-amdahl-46c9b4b/.github/workflows/\nhpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml\nhpc-carpentry-amdahl-46c9b4b/.gitignore\nhpc-carpentry-amdahl-46c9b4b/LICENSE\nhpc-carpentry-amdahl-46c9b4b/README.md\nhpc-carpentry-amdahl-46c9b4b/amdahl/\nhpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py\nhpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py\nhpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py\nhpc-carpentry-amdahl-46c9b4b/requirements.txt\nhpc-carpentry-amdahl-46c9b4b/setup.py\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This example output shows a folder which contains a few files, where ",(0,i.jsx)(n.code,{children:"46c9b4b"})," is an 8-character ",(0,i.jsx)(n.a,{href:"https://swcarpentry.github.io/git-novice/",children:"git"})," commit hash that will change when the source material is updated."]}),"\n",(0,i.jsxs)(n.p,{children:["Now let\u2019s unpack the archive. We\u2019ll run ",(0,i.jsx)(n.code,{children:"tar"})," with a few common flags:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-x"})," to extract the archive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-v"})," for verbose output"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-z"})," for gzip compression"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-f \xabtarball\xbb"})," for the file to be unpacked"]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Extract the Archive",type:"tip",children:[(0,i.jsxs)(n.p,{children:["Using the flags above, unpack the source code tarball into a new directory named \u201Camdahl\u201D using ",(0,i.jsx)(n.code,{children:"tar"}),"."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ tar -xvzf amdahl.tar.gz\nhpc-carpentry-amdahl-46c9b4b/\nhpc-carpentry-amdahl-46c9b4b/.github/\nhpc-carpentry-amdahl-46c9b4b/.github/workflows/\nhpc-carpentry-amdahl-46c9b4b/.github/workflows/python-publish.yml\nhpc-carpentry-amdahl-46c9b4b/.gitignore\nhpc-carpentry-amdahl-46c9b4b/LICENSE\nhpc-carpentry-amdahl-46c9b4b/README.md\nhpc-carpentry-amdahl-46c9b4b/amdahl/\nhpc-carpentry-amdahl-46c9b4b/amdahl/__init__.py\nhpc-carpentry-amdahl-46c9b4b/amdahl/__main__.py\nhpc-carpentry-amdahl-46c9b4b/amdahl/amdahl.py\nhpc-carpentry-amdahl-46c9b4b/requirements.txt\nhpc-carpentry-amdahl-46c9b4b/setup.py\n"})}),(0,i.jsxs)(n.p,{children:["Note that we did not need to type out ",(0,i.jsx)(n.code,{children:"-x -v -z -f"}),", thanks to flag concatenation, though the command works identically either way \u2013 so long as the concatenated list ends with ",(0,i.jsx)(n.code,{children:"f"}),", because the next string must specify the name of the file to extract."]})]}),"\n",(0,i.jsx)(n.p,{children:"The folder has an unfortunate name, so let\u2019s change that to something more convenient."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ mv hpc-carpentry-amdahl-46c9b4b amdahl\n"})}),"\n",(0,i.jsx)(n.p,{children:"Check the size of the extracted directory and compare to the compressed file size, using du for \u201Cdisk usage\u201D."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ du -sh amdahl.tar.gz\n8.0K     amdahl.tar.gz\n[user@laptop ~]$ du -sh amdahl\n48K    amdahl\n"})}),"\n",(0,i.jsx)(n.p,{children:"Text files (including Python source code) compress nicely: the \u201Ctarball\u201D is one-sixth the total size of the raw data!"}),"\n",(0,i.jsxs)(n.p,{children:["If you want to reverse the process \u2013 compressing raw data instead of extracting it \u2013 set a ",(0,i.jsx)(n.code,{children:"c"})," flag instead of ",(0,i.jsx)(n.code,{children:"x"}),", set the archive filename, then provide a directory to compress:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ tar -cvzf compressed_code.tar.gz amdahl\namdahl/\namdahl/.github/\namdahl/.github/workflows/\namdahl/.github/workflows/python-publish.yml\namdahl/.gitignore\namdahl/LICENSE\namdahl/README.md\namdahl/amdahl/\namdahl/amdahl/__init__.py\namdahl/amdahl/__main__.py\namdahl/amdahl/amdahl.py\namdahl/requirements.txt\namdahl/setup.py\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If you give ",(0,i.jsx)(n.code,{children:"amdahl.tar.gz"})," as the filename in the above command, ",(0,i.jsx)(n.code,{children:"tar"})," will update the existing tarball with any changes you made to the files. That would mean adding the new ",(0,i.jsx)(n.code,{children:"amdahl"})," folder to the ",(0,i.jsx)(n.em,{children:"existing"})," folder (",(0,i.jsx)(n.code,{children:"hpc-carpentry-amdahl-46c9b4b"}),") inside the tarball, doubling the size of the archive!"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Working with Windows",type:"tip",children:[(0,i.jsx)(n.p,{children:"When you transfer text files from a Windows system to a Unix system (Mac, Linux, BSD, Solaris, etc.) this can cause problems. Windows encodes its files slightly different than Unix, and adds an extra character to every line."}),(0,i.jsxs)(n.p,{children:["On a Unix system, every line in a file ends with a ",(0,i.jsx)(n.code,{children:"\\n"})," (newline). On Windows, every line in a file ends with a ",(0,i.jsx)(n.code,{children:"\\r\\n"})," (carriage return + newline). This causes problems sometimes."]}),(0,i.jsxs)(n.p,{children:["Though most modern programming languages and software handles this correctly, in some rare instances, you may run into an issue. The solution is to convert a file from Windows to Unix encoding with the ",(0,i.jsx)(n.code,{children:"dos2unix"})," command."]}),(0,i.jsxs)(n.p,{children:["You can identify if a file has Windows line endings with ",(0,i.jsx)(n.code,{children:"cat -A filename"}),". A file with Windows line endings will have ",(0,i.jsx)(n.code,{children:"^M$"})," at the end of every line. A file with Unix line endings will have ",(0,i.jsx)(n.code,{children:"$"})," at the end of a line."]}),(0,i.jsxs)(n.p,{children:["To convert the file, just run ",(0,i.jsx)(n.code,{children:"dos2unix filename"}),". (Conversely, to convert back to Windows format, you can run ",(0,i.jsx)(n.code,{children:"unix2dos filename"}),".)"]})]}),"\n",(0,i.jsxs)(n.h2,{id:"transferring-single-files-and-folders-with-scp",children:["Transferring Single Files and Folders With ",(0,i.jsx)(n.code,{children:"scp"})]}),"\n",(0,i.jsxs)(n.p,{children:["To copy a single file to or from the cluster, we can use ",(0,i.jsx)(n.code,{children:"scp"})," (\u201Csecure copy\u201D). The syntax can be a little complex for new users, but we\u2019ll break it down. The ",(0,i.jsx)(n.code,{children:"scp"})," command is a relative of the ",(0,i.jsx)(n.code,{children:"ssh"})," command we used to access the system, and can use the same public-key authentication mechanism."]}),"\n",(0,i.jsxs)(n.p,{children:["To ",(0,i.jsx)(n.em,{children:"upload"})," to another computer, the template command is"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ scp local_file NetID@login.torch.hpc.nyu.edu:remote_destination\n"})}),"\n",(0,i.jsxs)(n.p,{children:["in which ",(0,i.jsx)(n.code,{children:"@"})," and ",(0,i.jsx)(n.code,{children:":"})," are field separators and ",(0,i.jsx)(n.code,{children:"remote_destination"})," is a path relative to your remote home directory, or a new filename if you wish to change it, or both a relative path ",(0,i.jsx)(n.em,{children:"and"})," a new filename. If you don\u2019t have a specific folder in mind you can omit the ",(0,i.jsx)(n.code,{children:"remote_destination"})," and the file will be copied to your home directory on the remote computer (with its original name). If you include a ",(0,i.jsx)(n.code,{children:"remote_destination"}),", note that ",(0,i.jsx)(n.code,{children:"scp"})," interprets this the same way ",(0,i.jsx)(n.code,{children:"cp"})," does when making local copies: if it exists and is a folder, the file is copied inside the folder; if it exists and is a file, the file is overwritten with the contents of ",(0,i.jsx)(n.code,{children:"local_file"}),"; if it does not exist, it is assumed to be a destination filename for ",(0,i.jsx)(n.code,{children:"local_file"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Upload the lesson material to your remote home directory like so:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ scp amdahl.tar.gz NetID@login.torch.hpc.nyu.edu:\n"})}),"\n",(0,i.jsx)(n.h2,{id:"transferring-a-directory",children:"Transferring a Directory"}),"\n",(0,i.jsxs)(n.p,{children:["To transfer an entire directory, we add the ",(0,i.jsx)(n.code,{children:"-r"})," flag for \u201Crecursive\u201D: copy the item specified, and every item below it, and every item below those\u2026 until it reaches the bottom of the directory tree rooted at the folder name you provided."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ scp -r amdahl NetID@login.torch.hpc.nyu.edu:\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Caution",type:"warning",children:(0,i.jsxs)(n.p,{children:["For a large directory \u2013 either in size or number of files \u2013 copying with ",(0,i.jsx)(n.code,{children:"-r"})," can take a long time to complete."]})}),"\n",(0,i.jsxs)(n.p,{children:["When using ",(0,i.jsx)(n.code,{children:"scp"}),", you may have noticed that a ",(0,i.jsx)(n.code,{children:":"})," always follows the remote computer name. A string ",(0,i.jsx)(n.em,{children:"after"})," the ",(0,i.jsx)(n.code,{children:":"})," specifies the remote directory you wish to transfer the file or folder to, including a new name if you wish to rename the remote material. If you leave this field blank, ",(0,i.jsx)(n.code,{children:"scp"})," defaults to your home directory and the name of the local material to be transferred."]}),"\n",(0,i.jsxs)(n.p,{children:["On Linux computers, ",(0,i.jsx)(n.code,{children:"/"})," is the separator in file or directory paths. A path starting with a ",(0,i.jsx)(n.code,{children:"/"})," is called ",(0,i.jsx)(n.em,{children:"absolute"}),", since there can be nothing above the root ",(0,i.jsx)(n.code,{children:"/"}),". A path that does not start with ",(0,i.jsx)(n.code,{children:"/"})," is called ",(0,i.jsx)(n.em,{children:"relative"}),", since it is not anchored to the root."]}),"\n",(0,i.jsxs)(n.p,{children:["If you want to upload a file to a location inside your home directory \u2013 which is often the case \u2013 then you don\u2019t need a ",(0,i.jsx)(n.em,{children:"leading"})," ",(0,i.jsx)(n.code,{children:"/"}),". After the ",(0,i.jsx)(n.code,{children:":"}),", you can type the destination path relative to your home directory. If your home directory ",(0,i.jsx)(n.em,{children:"is"})," the destination, you can leave the destination field blank, or type ",(0,i.jsx)(n.code,{children:"~"})," \u2013 the shorthand for your home directory \u2013 for completeness."]}),"\n",(0,i.jsxs)(n.p,{children:["With ",(0,i.jsx)(n.code,{children:"scp"}),", a trailing slash on the target directory is optional, and has no effect. A trailing slash on a source directory is important for other commands, like ",(0,i.jsx)(n.code,{children:"rsync"}),"."]}),"\n",(0,i.jsxs)(n.admonition,{title:"A Note on rsync",type:"tip",children:[(0,i.jsxs)(n.p,{children:["As you gain experience with transferring files, you may find the ",(0,i.jsx)(n.code,{children:"scp"})," command limiting. The ",(0,i.jsx)(n.a,{href:"https://rsync.samba.org/",children:"rsync"})," utility provides advanced features for file transfer and is typically faster compared to both ",(0,i.jsx)(n.code,{children:"scp"})," and ",(0,i.jsx)(n.code,{children:"sftp"})," (see below). It is especially useful for transferring large and/or many files and for synchronizing folder contents between computers."]}),(0,i.jsxs)(n.p,{children:["The syntax is similar to ",(0,i.jsx)(n.code,{children:"scp"}),". To transfer to another computer with commonly used options:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -avP amdahl.tar.gz NetID@login.torch.hpc.nyu.edu:\n"})}),(0,i.jsx)(n.p,{children:"The options are:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-a"})," (archive) to preserve file timestamps, permissions, and folders, among other things; implies recursion"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-v"})," (verbose) to get verbose output to help monitor the transfer"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"-P"})," (partial/progress) to preserve partially transferred files in case of an interruption and also displays the progress of the transfer."]}),"\n"]}),(0,i.jsx)(n.p,{children:"To recursively copy a directory, we can use the same options:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -avP amdahl NetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.p,{children:"As written, this will place the local directory and its contents under your home directory on the remote system. If a trailing slash is added to the source, a new directory corresponding to the transferred directory will not be created, and the contents of the source directory will be copied directly into the destination directory."}),(0,i.jsx)(n.p,{children:"To download a file, we simply change the source and destination:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -avP NetID@login.torch.hpc.nyu.edu:amdahl ./\n"})})]}),"\n",(0,i.jsxs)(n.p,{children:["File transfers using both ",(0,i.jsx)(n.code,{children:"scp"})," and ",(0,i.jsx)(n.code,{children:"rsync"})," use SSH to encrypt data sent through the network. So, if you can connect via SSH, you will be able to transfer files. By default, SSH uses network port 22. If a custom SSH port is in use, you will have to specify it using the appropriate flag, often ",(0,i.jsx)(n.code,{children:"-p"}),", ",(0,i.jsx)(n.code,{children:"-P"}),", or ",(0,i.jsx)(n.code,{children:"--port"}),". Check ",(0,i.jsx)(n.code,{children:"--help"})," or the ",(0,i.jsx)(n.code,{children:"man"})," page if you\u2019re unsure."]}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsxs)(n.admonition,{title:"Change the Rsync Port",type:"info",children:[(0,i.jsxs)(n.p,{children:["Say we have to connect ",(0,i.jsx)(n.code,{children:"rsync"})," through port 768 instead of 22. How would we modify this command?"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync amdahl.tar.gz NetID@login.torch.hpc.nyu.edu:\n"})}),(0,i.jsxs)(n.p,{children:["Hint: check the ",(0,i.jsx)(n.code,{children:"man"})," page or \u201Chelp\u201D for ",(0,i.jsx)(n.code,{children:"rsync"}),". ",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.strong,{children:"[Click for Solution]"})]})]})}),(0,i.jsxs)(n.admonition,{title:"Solution",type:"tip",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ man rsync\n[user@laptop ~]$ rsync --help | grep port\n     --port=PORT             specify double-colon alternate port number\nSee http://rsync.samba.org/ for updates, bug reports, and answers\n[user@laptop ~]$ rsync --port=768 amdahl.tar.gz NetID@login.torch.hpc.nyu.edu:\n"})}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"This command will fail, as the correct port in this case is the default: 22."})})]})]}),"\n",(0,i.jsx)(n.h2,{id:"transferring-files-interactively-with-filezilla",children:"Transferring Files Interactively with FileZilla"}),"\n",(0,i.jsxs)(n.p,{children:["FileZilla is a cross-platform client for downloading and uploading files to and from a remote computer. It is absolutely fool-proof and always works quite well. It uses the ",(0,i.jsx)(n.code,{children:"sftp"})," protocol. You can read more about using the sftp protocol in the command line in the ",(0,i.jsx)(n.a,{href:"https://nyuhpc.github.io/hpc-intro/discuss/index.html",children:"lesson discussion"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Download and install the FileZilla client from ",(0,i.jsx)(n.a,{href:"https://filezilla-project.org",children:"https://filezilla-project.org"}),". After installing and opening the program, you should end up with a window with a file browser of your local system on the left hand side of the screen. When you connect to the cluster, your cluster files will appear on the right hand side."]}),"\n",(0,i.jsx)(n.p,{children:"To connect to the cluster, we\u2019ll just need to enter our credentials at the top of the screen:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Host: ",(0,i.jsx)(n.code,{children:"sftp://login.torch.hpc.nyu.edu"})]}),"\n",(0,i.jsx)(n.li,{children:"User: Your NetID"}),"\n",(0,i.jsx)(n.li,{children:"Password: Your NetID password"}),"\n",(0,i.jsx)(n.li,{children:"Port: (leave blank to use the default port)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Hit \u201CQuickconnect\u201D to connect. You should see your remote files appear on the right hand side of the screen. You can drag-and-drop files between the left (local) and right (remote) sides of the screen to transfer files."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Finally, if you need to move large files (typically larger than a gigabyte) from one remote computer to another remote computer, SSH in to the computer hosting the files and use ",(0,i.jsx)(n.code,{children:"scp"})," or ",(0,i.jsx)(n.code,{children:"rsync"})," to transfer over to the other. This will be more efficient than using FileZilla (or related applications) that would copy from the source to your local machine, then to the destination machine."]})}),"\n",(0,i.jsx)(n.h2,{id:"limiting-factors-of-data-transfer-speed",children:"Limiting Factors of Data Transfer Speed"}),"\n",(0,i.jsxs)(n.p,{children:["Data transfer speed may be limited by many different factors so the best data transfer mechanism to use depends on the type of data being transferred and where the data is going.  The components between your data\u2019s source and destination have varying levels of performance, and in particular, may have different capabilities with respect to ",(0,i.jsx)(n.em,{children:"bandwidth"})," and ",(0,i.jsx)(n.em,{children:"latency"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bandwidth"})," is generally the raw amount of data per unit time a device is capable of transmitting or receiving. It\u2019s a common and generally well-understood metric."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Latency"})," is a bit more subtle. For data transfers, it may be thought of as the amount of time it takes to get data out of storage and into a transmittable form. Latency issues are the reason it\u2019s advisable to execute data transfers by moving a small number of large files, rather than the converse."]}),"\n",(0,i.jsx)(n.p,{children:"Some of the key components and their associated issues are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Disk speed"}),": File systems on HPC systems are often highly parallel, consisting of a very large number of high performance disk drives. This allows them to support a very high data bandwidth. Unless the remote system has a similar parallel file system you may find your transfer speed limited by disk performance at that end."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Meta-data performance"}),": Meta-data operations such as opening and closing files or listing the owner or size of a file are much less parallel than read/write operations. If your data consists of a very large number of small files you may find your transfer speed is limited by meta-data operations. Meta-data operations performed by other users of the system can also interact strongly with those you perform so reducing the number of such operations you use (by combining multiple files into a single file) may reduce variability in your transfer rates and increase transfer speeds."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Network speed"}),": Data transfer performance can be limited by network speed. More importantly it is limited by the slowest section of the network between source and destination. If you are transferring to your laptop/workstation, this is likely to be its connection (either via LAN or WiFi)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Firewall speed"}),": Most modern networks are protected by some form of firewall that filters out malicious traffic. This filtering has some overhead and can result in a reduction in data transfer performance. The needs of a general purpose network that hosts email/web-servers and desktop machines are quite different from a research network that needs to support high volume data transfers. If you are trying to transfer data to or from a host on a general purpose network you may find the firewall for that network will limit the transfer rate you can achieve."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["As mentioned above, if you have related data that consists of a large number of small files it is strongly recommended to pack the files into a larger ",(0,i.jsx)(n.em,{children:"archive"})," file for long term storage and transfer. A single large file makes more efficient use of the file system and is easier to move, copy and transfer because significantly fewer metadata operations are required. Archive files can be created using tools like ",(0,i.jsx)(n.code,{children:"tar"})," and ",(0,i.jsx)(n.code,{children:"zip"}),". We have already met ",(0,i.jsx)(n.code,{children:"tar"})," when we talked about data transfer earlier."]}),"\n",(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Schematic of Network Bandwidth",src:t(78308).A+"",width:"487",height:"322"})}),(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Schematic diagram of bandwidth and latency for disk and network I/O. Each of the components on the figure is connected by a blue line of width proportional to the interface bandwidth.",(0,i.jsx)("br",{}),"The small mazes at the link points illustrate the latency of the link, with more tortuous mazes indicating higher latency."]})})]}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:(0,i.jsxs)(n.admonition,{title:"Consider the Best Way to Transfer Data",type:"info",children:[(0,i.jsx)(n.p,{children:"If you are transferring large amounts of data you will need to think about what may affect your transfer performance. It is always useful to run some tests that you can use to extrapolate how long it will take to transfer your data."}),(0,i.jsx)(n.p,{children:"Say you have a \u201Cdata\u201D folder containing 10,000 or so files, a healthy mix of small and large ASCII and binary data. Which of the following would be the best way to transfer them to Torch?"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ scp -r data NYUNetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -ra data NYUNetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -raz data NYUNetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ tar -cvf data.tar data\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -raz data.tar NYUNetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ tar -cvzf data.tar.gz data\n"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"[user@laptop ~]$ rsync -ra data.tar.gz NYUNetID@login.torch.hpc.nyu.edu:~/\n"})}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"[Click for Solution]"})})]})}),(0,i.jsx)(n.admonition,{title:"Solution",type:"tip",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scp"})," will recursively copy the directory. This works, but without compression."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rsync -ra"})," works like ",(0,i.jsx)(n.code,{children:"scp -r"}),", but preserves file information like creation times. This is marginally better."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rsync -raz"})," adds compression, which will save some bandwidth. If you have a strong CPU at both ends of the line, and you\u2019re on a slow network, this is a good choice."]}),"\n",(0,i.jsxs)(n.li,{children:["This command first uses ",(0,i.jsx)(n.code,{children:"tar"})," to merge everything into a single file, then ",(0,i.jsx)(n.code,{children:"rsync -z"})," to transfer it with compression. If you have a large number of files, metadata overhead can hamper your transfer, so this is a good idea."]}),"\n",(0,i.jsxs)(n.li,{children:["This command uses ",(0,i.jsx)(n.code,{children:"tar -z"})," to compress the archive, then ",(0,i.jsx)(n.code,{children:"rsync"})," to transfer it. This may perform similarly to the command directly above, but in most cases (for large datasets), it\u2019s the best combination of high throughput and low latency (making the most of your time and network connection)."]}),"\n"]})})]}),"\n",(0,i.jsx)(n.admonition,{title:"Key Points",type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"wget"})," and ",(0,i.jsx)(n.code,{children:"curl -O"})," download a file from the internet."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scp"})," and ",(0,i.jsx)(n.code,{children:"rsync"})," transfer files to and from your computer."]}),"\n",(0,i.jsx)(n.li,{children:"You can use an SFTP client like FileZilla to transfer files through a GUI."}),"\n"]})})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},78308(e,n,t){t.d(n,{A:()=>r});let r=t.p+"assets/images/schematic_network_bandwidth-16f2574f276682e886c6a7d089951e21.svg"},30416(e,n,t){t.d(n,{R:()=>a,x:()=>o});var r=t(59471);let i={},s=r.createContext(i);function a(e){let n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);